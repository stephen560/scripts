# First Function is for PowerShell to update Git for Windows

# Step 1: Define Git for Windows release URL
$releaseUrl = "https://api.github.com/repos/git-for-windows/git/releases/latest"

# Step 2: Get latest release info
$release = Invoke-RestMethod -Uri $releaseUrl -UseBasicParsing
$asset = $release.assets | Where-Object { $_.name -like "*64-bit.exe" } | Select-Object -First 1

# Step 3: Download installer
$installerPath = "$env:TEMP\$($asset.name)"
Invoke-WebRequest -Uri $asset.browser_download_url -OutFile $installerPath

# Step 4: Run installer silently
Start-Process -FilePath $installerPath -ArgumentList "/VERYSILENT /NORESTART" -Wait

Write-Host "âœ… Git for Windows has been updated to version $($release.tag_name)"


# Next Function is for PowerShell to update Notepad++ on Windows

# Define GitHub API URL for latest release
$apiUrl = "https://api.github.com/repos/notepad-plus-plus/notepad-plus-plus/releases/latest"

# Set TLS protocol for compatibility
[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12

# Get latest release info
Write-Host "Fetching latest Notepad++ release info..."
$release = Invoke-RestMethod -Uri $apiUrl -UseBasicParsing

# Find the installer asset (x64 version by default)
$asset = $release.assets | Where-Object { $_.name -like "*Installer.x64.exe" } | Select-Object -First 1

if (-not $asset) {
    Write-Host "Could not find installer asset. Exiting."
    exit 1
}

# Define download path
$installerPath = "$env:TEMP\npp_installer.exe"

# Download installer
Write-Host "Downloading $($asset.name)..."
Invoke-WebRequest -Uri $asset.browser_download_url -OutFile $installerPath

# Run installer silently
Write-Host "Installing Notepad++..."
Start-Process -FilePath $installerPath -ArgumentList "/S" -Wait

# Cleanup
Remove-Item $installerPath -Force
Write-Host "Notepad++ has been updated to version $($release.tag_name)!"


# Next Function is for PowerShell to update Node.js on Windows

# Define Node.js latest release URL (LTS recommended)
$apiUrl = "https://nodejs.org/dist/index.json"

# Ensure TLS compatibility
[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12

Write-Host "Fetching latest Node.js release info..."
$releases = Invoke-RestMethod -Uri $apiUrl -UseBasicParsing

# Pick the latest LTS version (most stable for production)
$latestLTS = $releases | Where-Object { $_.lts -ne $null } | Select-Object -First 1

if (-not $latestLTS) {
    Write-Host "Could not determine latest LTS release. Exiting."
    exit 1
}

$version = $latestLTS.version
Write-Host "Latest LTS version detected: $version"

# Construct download URL for Windows x64 MSI installer
$installerUrl = "https://nodejs.org/dist/$version/node-$($version)-x64.msi"
$installerPath = "$env:TEMP\node_installer.msi"

Write-Host "Downloading Node.js installer..."
Invoke-WebRequest -Uri $installerUrl -OutFile $installerPath

Write-Host "Installing Node.js silently..."
Start-Process -FilePath "msiexec.exe" -ArgumentList "/i `"$installerPath`" /quiet /norestart" -Wait

Write-Host "Cleaning up..."
Remove-Item $installerPath -Force

Write-Host "Node.js has been updated to version $version!"


# Next Function is to Force update Google Chrome on Windows

$chromeUpdatePath = "C:\Program Files (x86)\Google\Update\GoogleUpdate.exe"

if (Test-Path $chromeUpdatePath) {
    Write-Output "Running Chrome update..."
    & $chromeUpdatePath /update
} else {
    Write-Output "Google Update executable not found. Checking 32-bit path..."
    $chromeUpdatePath = "C:\Program Files (x86)\Google\Update\GoogleUpdate.exe"
    if (Test-Path $chromeUpdatePath) {
        Write-Output "Running Chrome update..."
        & $chromeUpdatePath /update
    } else {
        Write-Output "Google Update not found on this system."
    }
}

# Next Function is for PowerShell to update Visual Studio on Windows

$vsInstallerPath = "$env:C:\Program Files (x86)\Microsoft Visual Studio\Installer\vs_installer.exe"

# Check if the installer exists
if (Test-Path $vsInstallerPath) {
    Write-Host "Found Visual Studio Installer at $vsInstallerPath"
    
    # Run the installer with update command
    & $vsInstallerPath update --passive --norestart
    
    Write-Host "Update process started. Visual Studio will be updated if updates are available."
} else {
    Write-Host "Visual Studio Installer not found. Please install Visual Studio Installer first."
}


# Next Function is for PowerShell to update SQL Studio Management (SSMS) on Windows

# Define the download URL for the latest SSMS installer
# (Update this link when new versions are released)
$ssmsUrl = "https://aka.ms/ssmsfullsetup"

# Define local path to save installer
$installerPath = "$env:TEMP\SSMS-Setup.exe"

Write-Host "Downloading latest SSMS installer..."
Invoke-WebRequest -Uri $ssmsUrl -OutFile $installerPath

Write-Host "Running SSMS installer silently..."
Start-Process -FilePath $installerPath -ArgumentList "/install /quiet /norestart" -Wait

Write-Host "Update completed. Restart may be required."


# Next Function is for PowerShell to update Visual Studio Code on Windows

# Define download URL (latest stable build)
$VSCodeInstaller = "https://update.code.visualstudio.com/latest/win32-x64-user/stable"

# Define temporary path for installer
$InstallerPath = "$env:TEMP\vscode_installer.exe"

Write-Host "Downloading latest VS Code installer..."
Invoke-WebRequest -Uri $VSCodeInstaller -OutFile $InstallerPath

Write-Host "Running installer silently..."
Start-Process -FilePath $InstallerPath -ArgumentList "/silent","/mergetasks=!runcode" -Wait

Write-Host "Update complete. Cleaning up..."
Remove-Item $InstallerPath -Force

Write-Host "Visual Studio Code has been updated successfully!"












